<!DOCTYPE html>
<html>
<head>
  <title>Ask a Question</title>
</head>
<body>
  <h2>Ask a Question</h2>

  <label>Token:</label><br>
  <input type="text" id="token" placeholder="Paste your JWT token here" size="80"><br><br>

  <label>Title:</label><br>
  <input type="text" id="title" placeholder="Question title"><br><br>

  <label>Description:</label><br>
  <textarea id="description" placeholder="HTML description" rows="6" cols="60"></textarea><br><br>

  <label>Tags (comma-separated):</label><br>
  <input type="text" id="tags" placeholder="e.g. JavaScript, NodeJS"><br><br>

  <button onclick="submitQuestion()">Submit Question</button>

  <h3>Response:</h3>
  <pre id="responseBox"></pre>

  <script>
    async function submitQuestion() {
      const token = document.getElementById('token').value.trim();
      const title = document.getElementById('title').value.trim();
      const description = document.getElementById('description').value.trim();
      const tags = document.getElementById('tags').value.trim().split(',').map(t => t.trim()).filter(Boolean);

      const responseBox = document.getElementById('responseBox');
      responseBox.textContent = 'Sending...';

      if (!token || !title || !description) {
        responseBox.textContent = "❌ All fields (including token) are required.";
        return;
      }

      try {
        const res = await fetch('http://localhost:5000/api/questions/ask', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ title, description, tags })
        });

        const data = await res.json();

        if (!res.ok) {
          responseBox.textContent = `❌ ${data.message || "Error posting question"}`;
        } else {
          responseBox.textContent = `✅ Question posted!\n\n` + JSON.stringify(data, null, 2);
        }
      } catch (err) {
        responseBox.textContent = '❌ Error: ' + err.message;
      }
    }
  </script>
</body>
</html>
